Metadata-Version: 2.4
Name: ra-d-ps
Version: 1.0.0
Summary: Radiology XML parsing utilities for medical imaging data analysis
Author: RA-D-PS Team
License: MIT
Project-URL: Homepage, https://github.com/luvisaisa/RA-D-PS
Project-URL: Repository, https://github.com/luvisaisa/RA-D-PS
Project-URL: Documentation, https://github.com/luvisaisa/RA-D-PS/tree/main/docs
Keywords: radiology,xml,medical,imaging,data-analysis
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Healthcare Industry
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: pandas>=1.3.0
Requires-Dist: openpyxl>=3.0.0
Requires-Dist: lxml>=4.6.0
Provides-Extra: dev
Requires-Dist: pytest>=6.0; extra == "dev"
Requires-Dist: pytest-cov; extra == "dev"
Requires-Dist: black; extra == "dev"
Requires-Dist: flake8; extra == "dev"
Requires-Dist: mypy; extra == "dev"
Provides-Extra: gui
Requires-Dist: tkinter; extra == "gui"
Dynamic: license-file

# NYT XML Parser - Radiology Data Processing System

## üìã Overview

The NYT XML Parser is a comprehensive Python-based application designed to parse, analyze, and export radiology XML data from various medical imaging systems. Built specifically for handling complex radiology session data with multiple radiologist readings, nodule annotations, and coordinate mappings.

## üéØ Purpose

This system was developed to address the challenges of processing heterogeneous XML radiology data formats, providing researchers and medical professionals with tools to:

- Parse XML files from different radiology systems (NYT, LIDC formats)
- Extract radiologist readings, confidence scores, and nodule characteristics
- Handle multi-session radiologist reviews and unblinded readings
- Export data to standardized Excel templates and SQLite databases
- Perform advanced analytics on radiologist agreement and data quality
- Process large batches of files efficiently with progress tracking

## üèóÔ∏è Architecture Overview

### Core Components

```
NYT XML Parser/
‚îú‚îÄ‚îÄ main.py                     # Application entry point
‚îú‚îÄ‚îÄ XMLPARSE.py                 # Core GUI application and parsing engine
‚îú‚îÄ‚îÄ radiology_database.py       # SQLite database operations and analytics
‚îú‚îÄ‚îÄ config.py                   # Configuration management
‚îú‚îÄ‚îÄ enhanced_logging.py         # Advanced logging system
‚îî‚îÄ‚îÄ performance_config.py       # Performance optimization settings
```

### Data Flow Architecture

```
XML Files ‚Üí Parser Engine ‚Üí Data Validation ‚Üí Export Engine ‚Üí Output Files
    ‚Üì           ‚Üì              ‚Üì               ‚Üì            ‚Üì
Multi-format  Structure    Quality Checks   Template     Excel/SQLite
Detection     Analysis     Missing Values   Formatting   + Analytics
```

## üîß Technical Stack

- **Language**: Python 3.8+
- **GUI Framework**: Tkinter (custom-styled)
- **Data Processing**: Pandas, NumPy
- **Excel Operations**: OpenPyXL
- **Database**: SQLite3
- **XML Processing**: ElementTree
- **File Operations**: Cross-platform file handling

## üìÅ Project Structure

### Main Application (`main.py`)
- Entry point for the GUI application
- Window configuration and initialization
- Import error handling and system compatibility checks

### Core Parser (`XMLPARSE.py`)
The heart of the application containing:

#### GUI Components
- **NYTXMLGuiApp**: Main application class
- File/folder selection interfaces
- Progress tracking with live updates
- Export format selection dialogs
- Real-time processing feedback

#### Parsing Engine
- **parse_radiology_sample()**: Main XML parsing function
- **detect_parse_case()**: Intelligent XML structure detection
- **parse_multiple()**: Batch processing with memory optimization
- Multi-format support (NYT, LIDC, custom formats)

#### Data Processing
- **Template transformation**: Radiologist 1-4 column format
- **Nodule-centric organization**: Grouping by file and nodule
- **Quality validation**: Missing value detection and reporting
- **Memory optimization**: Batch processing for large datasets

#### Export Systems
- **Excel Export**: Multiple format options with rich formatting
- **SQLite Export**: Relational database with analytics capabilities
- **Template Format**: User-defined column structure
- **Multi-sheet organization**: Separate sheets per folder/parse case

### Database Operations (`radiology_database.py`)
- **RadiologyDatabase class**: SQLite wrapper with medical data focus
- **Batch operations**: Efficient data insertion and querying
- **Analytics engine**: Radiologist agreement analysis
- **Quality reporting**: Data completeness and consistency checks
- **Excel integration**: Database-to-Excel export with formatting

## üöÄ Features

### 1. XML Parsing Capabilities

#### Multi-Format Support
- **NYT Format**: Standard radiology XML with ResponseHeader structure
- **LIDC Format**: Lung Image Database Consortium XML structure
- **Custom Formats**: Extensible parsing for new XML schemas
- **Automatic Detection**: Intelligent format recognition

#### Parse Case Classification
```
Complete_Attributes      - Full radiologist data (confidence, subtlety, obscuration, reason)
With_Reason_Partial     - Includes reason field with partial attributes
Core_Attributes_Only    - Essential attributes without reason
Minimal_Attributes      - Limited attribute set
No_Characteristics      - Structure without characteristic data
LIDC_Single_Session     - Single LIDC reading session
LIDC_Multi_Session_X    - Multiple LIDC sessions (2-4 radiologists)
No_Sessions_Found       - XML without readable sessions
XML_Parse_Error         - Malformed or unparseable XML
Detection_Error         - Structure analysis failure
```

#### Data Extraction
- **Radiologist Information**: ID, session type, reading timestamps
- **Nodule Characteristics**: Confidence, subtlety, obscuration, diagnostic reason
- **Coordinate Data**: X, Y, Z coordinates with edge mapping
- **Medical Metadata**: StudyInstanceUID, SeriesInstanceUID, SOP_UID, modality
- **Session Classification**: Standard vs. Detailed coordinate sessions

### 2. File Processing Systems

#### Single File Processing
- Individual XML file parsing
- Immediate feedback on parse results
- Error handling and reporting
- Data preview capabilities

#### Folder Processing
- Recursive XML file discovery
- Batch processing with progress tracking
- Per-folder statistics and reporting
- Error isolation (continue on failure)

#### Multi-Folder Processing ‚≠ê **NEW FEATURE**
- **Combined Output**: Single Excel file with multiple sheets
- **Folder Organization**: Separate sheet per source folder
- **Template Format**: Radiologist 1-4 repeating column structure
- **Single Database**: Combined SQLite database for all folders
- **Progress Tracking**: Real-time processing updates with live logging

### 3. Export Formats

#### Excel Export Options

##### Standard Export
- **Parse case sheets**: Separate sheets by XML structure type
- **Session separation**: Detailed vs. Standard coordinate sessions
- **Color coding**: Parse case-based row highlighting
- **Missing value highlighting**: Orange highlighting for MISSING values
- **Auto-formatting**: Column width adjustment and alignment

##### Template Format ‚≠ê **NEW FEATURE**
- **Radiologist Columns**: Repeating "Radiologist 1", "Radiologist 2", "Radiologist 3", "Radiologist 4"
- **Compact Ratings**: Format like "Conf:5 | Sub:3 | Obs:2 | Reason:1"
- **Color Coordination**: Each radiologist column gets unique color scheme
- **Comprehensive Headers**: FileID, NoduleID, ParseCase, SessionType, coordinates, metadata

##### Multi-Folder Excel ‚≠ê **NEW FEATURE**
- **Combined Sheet**: "All Combined" with data from all folders
- **Individual Sheets**: One sheet per source folder
- **Consistent Formatting**: Template format across all sheets
- **Navigation**: Easy switching between folder views

#### SQLite Database Export

##### Database Structure
```sql
-- Core tables for relational data organization
sessions        - Individual radiologist reading sessions
nodules         - Unique nodule instances with metadata
radiologists    - Radiologist information and statistics
files           - Source file tracking and metadata
batches         - Processing batch management
quality_issues  - Data quality problem tracking
```

##### Analytics Capabilities
- **Radiologist Agreement**: Inter-rater reliability calculations
- **Data Quality Metrics**: Completeness, consistency analysis
- **Performance Statistics**: Processing time and success rates
- **Batch Tracking**: Historical processing information

##### Advanced Querying
- SQL query interface for custom analysis
- Predefined analytical views
- Export capabilities to Excel with formatting
- Integration with external analysis tools

### 4. Data Quality & Validation

#### Quality Checks
- **Missing Value Detection**: Identification of MISSING vs #N/A vs empty values
- **Data Completeness Analysis**: Per-column and overall completeness statistics
- **Type Validation**: Ensuring numeric fields contain valid numbers
- **Structure Validation**: XML schema compliance checking

#### User Interaction
- **Quality Warnings**: User prompts for data quality issues
- **Continue/Cancel Options**: User choice on problematic data
- **Detailed Reporting**: Comprehensive quality statistics
- **Column Hiding**: Auto-hide columns with >85% missing values

#### Error Handling
- **Graceful Degradation**: Continue processing on individual file failures
- **Error Logging**: Detailed error tracking with timestamps
- **User Feedback**: Clear error messages and resolution suggestions
- **Recovery Options**: Partial processing results preservation

### 5. User Interface

#### Main Interface
- **Clean Design**: Aptos font, consistent color scheme (#d7e3fc)
- **Intuitive Layout**: Logical workflow progression
- **File Management**: Easy file/folder selection and management
- **Export Options**: Clear choice between Excel and SQLite formats

#### Progress Tracking ‚≠ê **ENHANCED FEATURE**
- **Live Progress Bars**: Visual progress indication
- **Real-time Logging**: Timestamped activity log with color coding
- **File-by-file Updates**: Individual file processing status
- **Statistics Display**: Success/failure counts, processing rates
- **Auto-close Options**: Configurable completion behavior

#### Visual Feedback
- **Color-coded Messages**: Info (blue), success (green), warning (orange), error (red)
- **Creator Signature**: Animated signature popup on startup
- **Status Updates**: Contextual status information
- **Error Popups**: Temporary error notifications

### 6. Performance Optimization

#### Memory Management
- **Batch Processing**: Process files in configurable batches
- **Garbage Collection**: Explicit memory cleanup
- **Data Streaming**: Minimize memory footprint for large datasets
- **Efficient Data Structures**: Optimized data organization

#### Processing Optimization
- **Smart Sampling**: Intelligent sampling for column width calculation
- **Vectorized Operations**: Pandas optimization for data manipulation
- **Batch Database Operations**: Efficient SQLite bulk insertions
- **Parallel Processing Ready**: Architecture supports future parallelization

#### User Experience
- **Responsive UI**: Non-blocking progress updates
- **Background Processing**: Long operations don't freeze interface
- **Cancellation Options**: User can interrupt long operations
- **Resource Monitoring**: Memory and performance tracking

## üîÑ Development Roadmap

### Completed Features ‚úÖ

1. **Core XML Parsing Engine** - Multi-format XML processing
2. **GUI Application** - Complete Tkinter interface
3. **Excel Export System** - Multiple export formats with rich formatting
4. **SQLite Database Integration** - Relational database with analytics
5. **Multi-Folder Processing** - Combined output generation
6. **Template Format Export** - Radiologist 1-4 column structure
7. **Quality Validation System** - Comprehensive data quality checks
8. **Progress Tracking** - Real-time processing feedback
9. **Error Handling** - Robust error management and recovery

### Current Development üöß

#### Database GUI Project (In Planning)
A separate application for database analysis and visualization:
- **Database Browser**: Navigate and explore SQLite databases
- **Query Interface**: Visual SQL query builder
- **Analytics Dashboard**: Radiologist agreement analysis
- **Data Visualization**: Charts and graphs for data insights
- **Export Tools**: Advanced export options from database
- **Comparison Tools**: Compare multiple databases

### Future Enhancements üîÆ

#### Phase 1: Enhanced Analytics
- **Statistical Analysis**: Advanced inter-rater reliability metrics
- **Machine Learning Integration**: Anomaly detection in radiologist readings
- **Predictive Modeling**: Quality prediction based on XML structure
- **Batch Comparison**: Compare processing results across batches

#### Phase 2: Scalability Improvements
- **Parallel Processing**: Multi-core processing for large batches
- **Cloud Integration**: AWS/Azure processing capabilities
- **API Development**: REST API for automated processing
- **Docker Containerization**: Deployment and scaling support

#### Phase 3: Advanced Features
- **DICOM Integration**: Support for DICOM file processing
- **Web Interface**: Browser-based processing interface
- **Real-time Monitoring**: Live processing dashboards
- **Integration APIs**: Connect with hospital information systems

#### Phase 4: AI/ML Features
- **Natural Language Processing**: Extract insights from reason text
- **Computer Vision**: Image coordinate validation
- **Automated Quality Assessment**: AI-powered data quality scoring
- **Predictive Analytics**: Forecast processing outcomes

## üìä Technical Specifications

### System Requirements
- **Python**: 3.8 or higher
- **RAM**: Minimum 4GB, Recommended 8GB+
- **Storage**: 1GB+ free space for databases and exports
- **OS**: Windows 10+, macOS 10.14+, Linux (Ubuntu 18.04+)

### Performance Benchmarks
- **Small Dataset** (<1,000 files): ~2-5 minutes
- **Medium Dataset** (1,000-10,000 files): ~10-30 minutes  
- **Large Dataset** (10,000+ files): ~30+ minutes
- **Memory Usage**: ~100-500MB typical, scales with dataset size

### Dependencies
```python
# Core Dependencies
pandas>=1.3.0
openpyxl>=3.0.9
numpy>=1.21.0

# GUI and System
tkinter (built-in)
platform (built-in)
subprocess (built-in)

# Database
sqlite3 (built-in)

# XML Processing
xml.etree.ElementTree (built-in)
```

## üõ†Ô∏è Installation & Setup

### Quick Start
```bash
# Clone the repository
git clone <repository-url>
cd "XML PARSE"

# Install dependencies
pip install pandas openpyxl numpy

# Run the application
python main.py
```

### Development Setup
```bash
# Create virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install development dependencies
pip install -r requirements.txt

# Run tests (if available)
python -m pytest tests/

# Start development server
python main.py
```

## üìù Usage Examples

### Basic File Processing
1. Launch application: `python main.py`
2. Click "Select XML Files" or "Select Folders"
3. Choose export format (Excel/SQLite/Both)
4. Click "Export to Excel" or "Export to SQLite"
5. Monitor progress and review results

### Multi-Folder Processing
1. Click "Select Folders" ‚Üí "Multiple Folders"
2. Use Cmd+Click (macOS) to select multiple folders
3. Choose combined export format
4. Process creates single Excel with multiple sheets
5. Single SQLite database contains all folder data

### Template Format Export
1. Select files/folders for processing
2. Choose "Export to Excel"
3. System automatically applies template format
4. Results show Radiologist 1-4 columns with compact ratings

### Database Analysis
1. Export data to SQLite format
2. Use generated analysis Excel for quick insights
3. Query database directly using SQL tools
4. Future: Use Database GUI for advanced analysis

## üêõ Known Issues & Limitations

### Current Limitations
- **Single-threaded Processing**: No parallel processing yet
- **Memory Usage**: Large datasets can consume significant RAM
- **XML Format Support**: Limited to known formats (extensible)
- **Error Recovery**: Some XML errors cannot be automatically resolved

### Known Issues
- **Very Large Files**: Files >100MB may process slowly
- **Special Characters**: Some Unicode characters in XML may cause issues
- **Network Drives**: Processing from network locations may be slower
- **macOS Permissions**: May require permissions for file access

### Workarounds
- **Large Datasets**: Process in smaller batches
- **Memory Issues**: Close other applications during processing
- **File Errors**: Check XML validity before processing
- **Performance**: Use local storage for better performance

## ü§ù Contributing

### Development Guidelines
- Follow PEP 8 Python style guidelines
- Add docstrings to all functions and classes
- Include type hints where appropriate
- Write tests for new features
- Update documentation for changes

### Code Organization
- **main.py**: Entry point only, minimal logic
- **XMLPARSE.py**: Core functionality, well-documented
- **radiology_database.py**: Database operations
- **New features**: Consider separate modules for large features

### Testing
- Test with various XML formats
- Verify export formats work correctly
- Check error handling with malformed data
- Performance test with large datasets

## üìÑ License

This project was created by **Isa Lucia Schlichting** at **HFAN NYIT** for radiology data processing and analysis.

## üîó Project Links

- **Repository**: NYTXMLPARSE (GitHub)
- **Author**: luvisaisa
- **Created**: 2025
- **Language**: Python

## üìû Support

For issues, questions, or contributions:
- Create an issue in the GitHub repository
- Review existing documentation
- Check known issues section
- Contact development team

---

*Last Updated: August 12, 2025*
*Version: 2.0*
*Status: Active Development*
